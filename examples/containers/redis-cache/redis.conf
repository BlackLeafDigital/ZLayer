# Redis configuration file
#
# Mount this file at /usr/local/etc/redis/redis.conf and start Redis with:
#   redis-server /usr/local/etc/redis/redis.conf
#
# In deployment.yaml, add:
#   command:
#     - redis-server
#     - /usr/local/etc/redis/redis.conf
#   volumes:
#     - name: redis-config
#       path: /usr/local/etc/redis/redis.conf
#       source: ./redis.conf
#       read_only: true

# Network
bind 0.0.0.0
port 6379
tcp-keepalive 300
timeout 0

# Memory Management
maxmemory 200mb
maxmemory-policy allkeys-lru

# Eviction sampling
maxmemory-samples 10

# Persistence (disabled for cache-only)
# Uncomment for persistent storage
# save 900 1
# save 300 10
# save 60 10000
save ""

# AOF persistence (disabled for cache-only)
# Uncomment for durability
# appendonly yes
# appendfsync everysec
# auto-aof-rewrite-percentage 100
# auto-aof-rewrite-min-size 64mb
appendonly no

# Logging
loglevel notice
# logfile ""  # Log to stdout for container environments

# Performance
tcp-backlog 511
databases 16

# Lazy freeing (background deletion)
lazyfree-lazy-eviction yes
lazyfree-lazy-expire yes
lazyfree-lazy-server-del yes

# Threaded I/O (Redis 6+)
# io-threads 4
# io-threads-do-reads yes

# Security
# requirepass your-password-here
# rename-command CONFIG ""
# rename-command FLUSHALL ""
# rename-command FLUSHDB ""
# rename-command DEBUG ""

# Snapshotting (when persistence enabled)
# rdbcompression yes
# rdbchecksum yes
# dbfilename dump.rdb
# dir /data

# Replication (for primary-replica setup)
# replicaof <masterip> <masterport>
# masterauth <master-password>
# replica-serve-stale-data yes
# replica-read-only yes

# Cluster (for Redis Cluster mode)
# cluster-enabled yes
# cluster-config-file nodes.conf
# cluster-node-timeout 5000
